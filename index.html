<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quote Vault</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&family=DM+Sans:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/src/styles.css">
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="spinner"></div>
        <p data-i18n="app.loading">Cargando...</p>
    </div>

    <!-- Auth Screen -->
    <div class="auth-screen hidden" id="authScreen">
        <div class="auth-box">
            <h1 data-i18n="app.title">Quote Vault</h1>
            <p data-i18n="app.subtitle">Tu repositorio personal de citas</p>

            <button class="btn-google" id="googleSignIn">
                <svg viewBox="0 0 24 24" width="20" height="20">
                    <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                    <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                    <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                    <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                </svg>
                <span data-i18n="auth.continueWithGoogle">Continuar con Google</span>
            </button>

            <div class="auth-divider">
                <span data-i18n="auth.or">o</span>
            </div>

            <div class="auth-tabs">
                <button type="button" class="auth-tab active" data-tab="login" data-i18n="auth.login">Iniciar sesi√≥n</button>
                <button type="button" class="auth-tab" data-tab="register" data-i18n="auth.register">Registrarse</button>
            </div>

            <form class="auth-form" id="authForm">
                <div class="form-group hidden" id="displayNameGroup">
                    <input type="text" id="authDisplayName" data-i18n-placeholder="auth.displayNamePlaceholder" placeholder="Tu nombre o apodo" minlength="2">
                </div>
                <div class="form-group">
                    <input type="email" id="authEmail" data-i18n-placeholder="auth.emailPlaceholder" placeholder="Email" required>
                </div>
                <div class="form-group">
                    <input type="password" id="authPassword" data-i18n-placeholder="auth.passwordPlaceholder" placeholder="Contrase√±a" required minlength="8">
                    <small class="password-hint hidden" id="passwordHint" data-i18n="auth.passwordHint">M√≠nimo 8 caracteres, una may√∫scula, una min√∫scula y un n√∫mero</small>
                </div>
                <button type="submit" class="btn btn-primary" id="authSubmit" data-i18n="auth.login">Iniciar sesi√≥n</button>
            </form>

            <p class="auth-error" id="authError"></p>
        </div>
    </div>

    <!-- Email Verification Screen -->
    <div class="auth-screen hidden" id="verifyScreen">
        <div class="auth-box">
            <h1 data-i18n="auth.verifyEmail">Verifica tu email</h1>
            <p data-i18n="auth.verificationSent">Hemos enviado un enlace de verificaci√≥n a:</p>
            <p class="verify-email" id="verifyEmail"></p>
            <p class="verify-instructions" data-i18n="auth.verificationInstructions">Revisa tu bandeja de entrada (y spam) y haz clic en el enlace para activar tu cuenta.</p>
            <button class="btn btn-secondary" id="resendVerification" data-i18n="auth.resendEmail">Reenviar email</button>
            <button class="btn-link" id="useAnotherAccount" data-i18n="auth.useAnotherAccount">Usar otra cuenta</button>
        </div>
    </div>

    <!-- Main App -->
    <div class="app-layout hidden" id="mainApp">
        <!-- Left Sidebar Navigation -->
        <aside class="nav-sidebar" id="navSidebar">
            <div class="nav-sidebar-header">
                <h1 class="nav-sidebar-title" data-i18n="app.title">Knowledge Vault</h1>
                <button class="nav-sidebar-toggle" id="sidebarToggle" aria-label="Toggle sidebar">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg>
                </button>
            </div>

            <div class="nav-sidebar-content">
                <!-- Main Navigation Tabs -->
                <div class="nav-main-tabs">
                    <button class="nav-main-tab" data-view="wiki" id="navWikiTab">
                        <span class="nav-tab-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                                <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                            </svg>
                        </span>
                        <span class="nav-tab-label" data-i18n="sidebar.wiki">Wiki</span>
                    </button>
                    <button class="nav-main-tab" data-view="insights" id="navInsightsTab">
                        <span class="nav-tab-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <path d="M9 18h6"></path>
                                <path d="M10 22h4"></path>
                                <path d="M12 2a7 7 0 0 0-4 12.73V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.27A7 7 0 0 0 12 2z"></path>
                            </svg>
                        </span>
                        <span class="nav-tab-label" data-i18n="sidebar.insights">Insights</span>
                        <span class="nav-tab-badge hidden" id="insightsDraftBadge">0</span>
                    </button>
                    <button class="nav-main-tab active" data-view="quotes" id="navQuotesTab">
                        <span class="nav-tab-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <path d="M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V21z"></path>
                                <path d="M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v4z"></path>
                            </svg>
                        </span>
                        <span class="nav-tab-label" data-i18n="sidebar.quotes">Citas</span>
                    </button>
                </div>

                <!-- Wiki Section (Topics) -->
                <div class="nav-view-content" id="navWikiContent" style="display: none;">
                    <div class="nav-section">
                        <div class="nav-section-header">
                            <span class="nav-section-title" data-i18n="sidebar.topics">Temas</span>
                            <span class="nav-section-count" id="totalTopics">0</span>
                        </div>
                        <div class="nav-section-items" id="sidebarTopics">
                            <!-- Topics will be rendered here -->
                        </div>
                        <button class="nav-add-btn" id="navNewTopicBtn">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                            <span data-i18n="sidebar.newTopic">Nuevo tema</span>
                        </button>
                    </div>
                </div>

                <!-- Insights Section -->
                <div class="nav-view-content" id="navInsightsContent" style="display: none;">
                    <div class="nav-section">
                        <button type="button" class="nav-section-header nav-section-button" id="allInsightsHeader">
                            <span class="nav-section-title" data-i18n="sidebar.allInsights">Todos los insights</span>
                            <span class="nav-section-count" id="totalInsights">0</span>
                        </button>
                    </div>
                    <div class="nav-section">
                        <div class="nav-section-header collapsible" id="insightStatusHeader">
                            <span class="nav-section-title" data-i18n="sidebar.byStatus">Por estado</span>
                            <svg class="nav-chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </div>
                        <div class="nav-section-items" id="sidebarInsightStatus">
                            <button class="nav-item" data-status="draft">
                                <span class="status-dot draft"></span>
                                <span data-i18n="insights.draft">Borradores</span>
                                <span class="item-count" id="insightsDraftCount">0</span>
                            </button>
                            <button class="nav-item" data-status="reviewed">
                                <span class="status-dot reviewed"></span>
                                <span data-i18n="insights.reviewed">Revisados</span>
                                <span class="item-count" id="insightsReviewedCount">0</span>
                            </button>
                            <button class="nav-item" data-status="integrated">
                                <span class="status-dot integrated"></span>
                                <span data-i18n="insights.integrated">Integrados</span>
                                <span class="item-count" id="insightsIntegratedCount">0</span>
                            </button>
                        </div>
                    </div>
                    <button class="nav-add-btn" id="navNewInsightBtn">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        <span data-i18n="sidebar.captureInsight">Capturar insight</span>
                    </button>
                </div>

                <!-- Quotes Section -->
                <div class="nav-view-content" id="navQuotesContent">
                    <div class="nav-section">
                        <div class="nav-section-header">
                            <span class="nav-section-title" data-i18n="sidebar.allQuotes">Todas las citas</span>
                            <span class="nav-section-count" id="totalQuotes">0</span>
                        </div>
                    </div>

                    <!-- Collections -->
                    <div class="nav-section">
                        <div class="nav-section-header collapsible" id="collectionsHeader">
                            <span class="nav-section-title" data-i18n="sidebar.collections">Colecciones</span>
                            <svg class="nav-chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </div>
                        <div class="nav-section-items" id="sidebarCollections">
                            <!-- Collections will be rendered here -->
                        </div>
                        <button class="nav-add-btn" id="navNewCollectionBtn">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                            <span data-i18n="sidebar.newCollection">Nueva colecci√≥n</span>
                        </button>
                    </div>

                    <!-- Tags -->
                    <div class="nav-section">
                        <div class="nav-section-header collapsible" id="tagsHeader">
                            <span class="nav-section-title" data-i18n="sidebar.tags">Tags</span>
                            <svg class="nav-chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </div>
                        <div class="nav-section-items nav-tags" id="sidebarTags">
                            <!-- Tags will be rendered here -->
                        </div>
                    </div>
                </div>
            </div>

            <div class="nav-sidebar-footer">
                <div class="nav-user-info">
                    <span class="nav-user-email" id="userEmail"></span>
                </div>
                <div class="nav-footer-actions">
                    <div class="language-selector" id="languageSelector">
                        <button type="button" class="language-btn" id="languageBtn">
                            <span id="currentLang">ES</span>
                        </button>
                        <div class="language-dropdown" id="languageDropdown">
                            <button type="button" class="language-option active" data-lang="es">
                                <svg class="flag" viewBox="0 0 640 480">
                                    <path fill="#c60b1e" d="M0 0h640v480H0z"/>
                                    <path fill="#ffc400" d="M0 120h640v240H0z"/>
                                </svg>
                                <span data-i18n="language.es">Espa√±ol</span>
                                <svg class="check" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="20 6 9 17 4 12"></polyline>
                                </svg>
                            </button>
                            <button type="button" class="language-option" data-lang="en">
                                <svg class="flag" viewBox="0 0 640 480">
                                    <path fill="#012169" d="M0 0h640v480H0z"/>
                                    <path fill="#FFF" d="m75 0 244 181L562 0h78v62L400 241l240 178v61h-80L320 301 81 480H0v-60l239-178L0 64V0h75z"/>
                                    <path fill="#C8102E" d="m424 281 216 159v40L369 281h55zm-184 20 6 35L54 480H0l240-179zM640 0v3L391 191l2-44L590 0h50zM0 0l239 176h-60L0 42V0z"/>
                                    <path fill="#FFF" d="M241 0v480h160V0H241zM0 160v160h640V160H0z"/>
                                    <path fill="#C8102E" d="M0 193v96h640v-96H0zM273 0v480h96V0h-96z"/>
                                </svg>
                                <span data-i18n="language.en">English</span>
                                <svg class="check" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="20 6 9 17 4 12"></polyline>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <button class="nav-logout-btn" id="logoutBtn" data-i18n="app.logout">Salir</button>
                </div>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="main-area">
            <!-- Sidebar open button (visible when sidebar is collapsed) -->
            <button class="sidebar-open-btn" id="sidebarOpenBtn" aria-label="Open sidebar">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="3" y1="12" x2="21" y2="12"></line>
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <line x1="3" y1="18" x2="21" y2="18"></line>
                </svg>
            </button>
            <!-- Mobile Header -->
            <header class="mobile-header">
            <div class="mobile-header-top">
                <h1 data-i18n="app.title">Quote Vault</h1>
                <div class="mobile-header-actions">
                    <div class="language-selector" id="languageSelectorMobile">
                        <button type="button" class="language-btn" id="languageBtnMobile">
                            <span id="currentLangMobile">ES</span>
                        </button>
                        <div class="language-dropdown" id="languageDropdownMobile">
                            <button type="button" class="language-option active" data-lang="es">
                                <svg class="flag" viewBox="0 0 640 480">
                                    <path fill="#c60b1e" d="M0 0h640v480H0z"/>
                                    <path fill="#ffc400" d="M0 120h640v240H0z"/>
                                </svg>
                                <span>Espa√±ol</span>
                            </button>
                            <button type="button" class="language-option" data-lang="en">
                                <svg class="flag" viewBox="0 0 640 480">
                                    <path fill="#012169" d="M0 0h640v480H0z"/>
                                    <path fill="#FFF" d="m75 0 244 181L562 0h78v62L400 241l240 178v61h-80L320 301 81 480H0v-60l239-178L0 64V0h75z"/>
                                    <path fill="#C8102E" d="m424 281 216 159v40L369 281h55zm-184 20 6 35L54 480H0l240-179zM640 0v3L391 191l2-44L590 0h50zM0 0l239 176h-60L0 42V0z"/>
                                    <path fill="#FFF" d="M241 0v480h160V0H241zM0 160v160h640V160H0z"/>
                                    <path fill="#C8102E" d="M0 193v96h640v-96H0zM273 0v480h96V0h-96z"/>
                                </svg>
                                <span>English</span>
                            </button>
                        </div>
                    </div>
                    <button class="icon-btn" id="mobileMenuBtn" aria-label="Menu">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="1"></circle>
                            <circle cx="19" cy="12" r="1"></circle>
                            <circle cx="5" cy="12" r="1"></circle>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="mobile-search-bar">
                <div class="mobile-search-wrapper">
                    <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                    <input type="text" class="mobile-search-input" id="mobileSearchInput" data-i18n-placeholder="quotes.searchPlaceholder" placeholder="Buscar...">
                </div>
                <button class="icon-btn filter-btn" id="filterToggleBtn" aria-label="Filtros">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                    </svg>
                    <span class="filter-badge hidden" id="filterBadge">0</span>
                </button>
            </div>
        </header>

        <!-- Mobile Menu Dropdown -->
        <div class="mobile-menu hidden" id="mobileMenu">
            <div class="mobile-menu-header">
                <span class="user-email-mobile" id="userEmailMobile"></span>
                <button class="btn btn-secondary btn-small" id="logoutBtnMobile" data-i18n="app.logout">Salir</button>
            </div>
            <div class="mobile-menu-stats">
                <span id="totalQuotesMobile">0</span> <span data-i18n="quotes.savedQuotes">citas guardadas</span>
            </div>
        </div>

        <!-- Filters Panel (collapsible on mobile) -->
        <div class="filters-panel hidden" id="filtersPanel">
            <div class="filters-panel-header">
                <h3 data-i18n="filters.title">Filtros</h3>
                <button class="icon-btn" id="closeFiltersBtn" aria-label="Cerrar">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="filters-panel-content">
                <!-- Mobile filters will be populated here -->
            </div>
            <div class="filters-panel-actions">
                <button class="btn btn-secondary" id="clearFiltersBtn" data-i18n="filters.clear">Limpiar</button>
                <button class="btn btn-primary" id="applyFiltersBtn" data-i18n="filters.apply">Aplicar</button>
            </div>
        </div>
        <div class="filters-overlay hidden" id="filtersOverlay"></div>

        <!-- Desktop Header with Filters -->
        <header class="content-header desktop-header">
            <div class="content-filters">
                <input type="text" class="search-box" id="searchInput" data-i18n-placeholder="quotes.searchPlaceholder" placeholder="Buscar por texto, autor o fuente...">

                <!-- Stance Filter -->
                <div class="custom-select" id="stanceSelect">
                    <button type="button" class="custom-select-btn">
                        <span class="selected-text" data-i18n="quotes.allStances">Todas las posturas</span>
                        <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </button>
                    <div class="custom-select-dropdown">
                        <button type="button" class="custom-select-option active" data-value="">
                            <span data-i18n="quotes.allStances">Todas las posturas</span>
                            <svg class="check" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="20 6 9 17 4 12"></polyline>
                            </svg>
                        </button>
                        <button type="button" class="custom-select-option" data-value="favor">
                            <span data-i18n="stances.favor">A favor</span>
                            <svg class="check" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="20 6 9 17 4 12"></polyline>
                            </svg>
                        </button>
                        <button type="button" class="custom-select-option" data-value="contra">
                            <span data-i18n="stances.contra">En contra</span>
                            <svg class="check" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="20 6 9 17 4 12"></polyline>
                            </svg>
                        </button>
                        <button type="button" class="custom-select-option" data-value="neutral">
                            <span data-i18n="stances.neutral">Neutral</span>
                            <svg class="check" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="20 6 9 17 4 12"></polyline>
                            </svg>
                        </button>
                    </div>
                    <select id="filterStance" hidden>
                        <option value="">Todas las posturas</option>
                        <option value="favor">A favor</option>
                        <option value="contra">En contra</option>
                        <option value="neutral">Neutral</option>
                    </select>
                </div>

                <!-- Favorite Filter -->
                <div class="custom-select" id="favoriteSelect">
                    <button type="button" class="custom-select-btn">
                        <span class="selected-text" data-i18n="quotes.all">Todas</span>
                        <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </button>
                    <div class="custom-select-dropdown">
                        <button type="button" class="custom-select-option active" data-value="">
                            <span data-i18n="quotes.all">Todas</span>
                            <svg class="check" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="20 6 9 17 4 12"></polyline>
                            </svg>
                        </button>
                        <button type="button" class="custom-select-option" data-value="true">
                            <span data-i18n="quotes.favorites">Destacadas</span>
                            <svg class="check" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="20 6 9 17 4 12"></polyline>
                            </svg>
                        </button>
                    </div>
                    <select id="filterFavorite" hidden>
                        <option value="">Todas</option>
                        <option value="true">Destacadas</option>
                    </select>
                </div>

                <!-- Sort -->
                <div class="custom-select" id="sortSelect">
                    <button type="button" class="custom-select-btn">
                        <span class="selected-text" data-i18n="quotes.newest">M√°s recientes</span>
                        <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </button>
                    <div class="custom-select-dropdown">
                        <button type="button" class="custom-select-option active" data-value="newest">
                            <span data-i18n="quotes.newest">M√°s recientes</span>
                            <svg class="check" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="20 6 9 17 4 12"></polyline>
                            </svg>
                        </button>
                        <button type="button" class="custom-select-option" data-value="oldest">
                            <span data-i18n="quotes.oldest">M√°s antiguas</span>
                            <svg class="check" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="20 6 9 17 4 12"></polyline>
                            </svg>
                        </button>
                        <button type="button" class="custom-select-option" data-value="author">
                            <span data-i18n="quotes.byAuthor">Por autor</span>
                            <svg class="check" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="20 6 9 17 4 12"></polyline>
                            </svg>
                        </button>
                    </div>
                    <select id="sortBy" hidden>
                        <option value="newest">M√°s recientes</option>
                        <option value="oldest">M√°s antiguas</option>
                        <option value="author">Por autor</option>
                    </select>
                </div>

                <!-- Hidden collection filter (controlled by sidebar) -->
                <select id="filterCollection" hidden>
                    <option value="">Todas las colecciones</option>
                </select>

                <button class="btn btn-primary btn-icon-text" id="newQuoteBtn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    <span data-i18n="quotes.newQuote">Nueva cita</span>
                </button>
            </div>
        </header>

        <!-- Content Body -->
        <div class="content-body">
            <div class="view-controls">
                <button class="view-btn active" id="viewList" data-i18n-title="quotes.listView" title="Vista lista">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
                <button class="view-btn" id="viewCompare" data-i18n-title="quotes.compareView" title="Vista comparativa">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="7" height="18"></rect>
                        <rect x="14" y="3" width="7" height="18"></rect>
                    </svg>
                </button>
            </div>

            <div class="quotes-list" id="quotesList"></div>

            <div class="quotes-compare hidden" id="quotesCompare">
                <div class="compare-column favor">
                    <h3 data-i18n="stances.favor">A favor</h3>
                    <div class="compare-quotes" id="quotesFavor"></div>
                </div>
                <div class="compare-column against">
                    <h3 data-i18n="stances.contra">En contra</h3>
                    <div class="compare-quotes" id="quotesAgainst"></div>
                </div>
            </div>

            <div class="empty-state hidden" id="emptyState">
                <h3 data-i18n="quotes.emptyTitle">Tu colecci√≥n est√° vac√≠a</h3>
                <p data-i18n="quotes.emptyMessage">Comienza a√±adiendo tu primera cita memorable</p>
            </div>
        </div>

        <!-- Mobile FAB -->
        <button class="mobile-fab" id="mobileFab" aria-label="Nueva cita">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
        </button>
    </main>
    </div>

    <!-- Modal -->
    <div class="modal-overlay" id="modal">
        <div class="modal">
            <h2 id="modalTitle" data-i18n="quotes.newQuote">Nueva cita</h2>
            <form id="quoteForm">
                <input type="hidden" id="quoteId">

                <div class="form-group">
                    <label for="quoteText" data-i18n="form.quoteLabel">Cita *</label>
                    <textarea id="quoteText" required data-i18n-placeholder="form.quotePlaceholder" placeholder="Escribe la cita aqu√≠..."></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="quoteAuthor" data-i18n="form.authorLabel">Autor *</label>
                        <input type="text" id="quoteAuthor" required data-i18n-placeholder="form.authorPlaceholder" placeholder="Nombre del autor">
                    </div>
                    <div class="form-group">
                        <label for="quoteSource" data-i18n="form.sourceLabel">Fuente</label>
                        <input type="text" id="quoteSource" data-i18n-placeholder="form.sourcePlaceholder" placeholder="Libro, art√≠culo, discurso...">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="quoteCollection" data-i18n="form.collectionLabel">Colecci√≥n</label>
                        <div class="collection-input">
                            <select id="quoteCollection">
                                <option value="" data-i18n="quotes.noCollection">Sin colecci√≥n</option>
                            </select>
                            <button type="button" class="btn-icon" id="newCollectionBtn" data-i18n-title="collections.newCollection" title="Nueva colecci√≥n">+</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="quoteStance" data-i18n="form.stanceLabel">Tu postura</label>
                        <select id="quoteStance" data-i18n-options>
                            <option value="neutral" data-i18n="stances.neutral">Neutral</option>
                            <option value="favor" data-i18n="stances.favor">A favor</option>
                            <option value="contra" data-i18n="stances.contra">En contra</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="quoteTags" data-i18n="form.tagsLabel">Etiquetas</label>
                    <input type="text" id="quoteTags" data-i18n-placeholder="form.tagsPlaceholder" placeholder="Separadas por coma: filosof√≠a, √©tica, vida">
                </div>

                <div class="form-group">
                    <label for="quoteNotes" data-i18n="form.notesLabel">Notas personales</label>
                    <textarea id="quoteNotes" data-i18n-placeholder="form.notesPlaceholder" placeholder="Tu reflexi√≥n o comentario sobre esta cita..."></textarea>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancelModalBtn" data-i18n="form.cancel">Cancelar</button>
                    <button type="submit" class="btn btn-primary" id="saveBtn" data-i18n="form.save">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Confirm Modal -->
    <div class="confirm-overlay" id="confirmModal">
        <div class="confirm-box">
            <h3 id="confirmTitle" data-i18n="confirm.areYouSure">¬øEst√°s seguro?</h3>
            <p id="confirmMessage" data-i18n="confirm.cannotUndo">Esta acci√≥n no se puede deshacer.</p>
            <div class="confirm-actions">
                <button class="btn btn-secondary" id="confirmCancel" data-i18n="form.cancel">Cancelar</button>
                <button class="btn btn-danger" id="confirmAction" data-i18n="quotes.delete">Eliminar</button>
            </div>
        </div>
    </div>

    <!-- New Collection Modal -->
    <div class="confirm-overlay" id="collectionModal">
        <div class="confirm-box">
            <h3 data-i18n="collections.newCollection">Nueva colecci√≥n</h3>
            <p data-i18n="collections.createDescription">Crea una colecci√≥n para organizar citas por tema de debate.</p>
            <input type="text" id="newCollectionName" class="collection-name-input" data-i18n-placeholder="collections.namePlaceholder" placeholder="Ej: Cambio clim√°tico, IA, √âtica...">
            <div class="confirm-actions">
                <button class="btn btn-secondary" id="cancelCollectionBtn" data-i18n="form.cancel">Cancelar</button>
                <button class="btn btn-primary" id="createCollectionBtn" data-i18n="collections.create">Crear</button>
            </div>
        </div>
    </div>

    <!-- Insight Capture Modal -->
    <div class="modal-overlay" id="insightModal">
        <div class="modal modal-large">
            <h2 id="insightModalTitle" data-i18n="insights.capture">Capturar insight</h2>
            <form id="insightForm">
                <input type="hidden" id="insightId">

                <div class="form-group">
                    <label for="insightSourceUrl" data-i18n="insights.sourceUrl">URL de la fuente</label>
                    <div class="url-input-wrapper">
                        <input type="url" id="insightSourceUrl" data-i18n-placeholder="insights.sourceUrlPlaceholder" placeholder="Pega la URL del video, art√≠culo...">
                        <button type="button" class="btn btn-secondary btn-small" id="fetchMetadataBtn">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                <path d="M9 12l2 2 4-4"></path>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Source Preview (populated after URL fetch) -->
                <div class="source-preview hidden" id="sourcePreview">
                    <img class="source-thumbnail" id="sourceThumbnail" src="" alt="">
                    <div class="source-info">
                        <span class="source-type-badge" id="sourceTypeBadge">YouTube</span>
                        <h4 class="source-title" id="sourceTitle"></h4>
                        <p class="source-channel" id="sourceChannel"></p>
                    </div>
                </div>

                <div class="form-group">
                    <label for="insightNotes" data-i18n="insights.notes">Apuntes</label>
                    <textarea id="insightNotes" rows="8" data-i18n-placeholder="insights.notesPlaceholder" placeholder="Escribe tus apuntes mientras consumes el contenido..."></textarea>
                </div>

                <div class="form-group">
                    <label for="insightTags" data-i18n="form.tagsLabel">Etiquetas</label>
                    <input type="text" id="insightTags" data-i18n-placeholder="form.tagsPlaceholder" placeholder="Separadas por coma: pol√≠tica, historia, econom√≠a">
                </div>

                <div class="form-group">
                    <label for="insightLinkedTopic" data-i18n="insights.linkToTopic">Vincular a tema (opcional)</label>
                    <select id="insightLinkedTopic">
                        <option value="">Sin vincular</option>
                        <!-- Topics will be populated here -->
                    </select>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancelInsightBtn" data-i18n="form.cancel">Cancelar</button>
                    <button type="submit" class="btn btn-primary" id="saveInsightBtn" data-i18n="form.save">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- New Topic Modal -->
    <div class="modal-overlay" id="topicModal">
        <div class="modal">
            <h2 id="topicModalTitle" data-i18n="topics.newTopic">Nuevo tema</h2>
            <form id="topicForm">
                <input type="hidden" id="topicId">

                <div class="form-group">
                    <label for="topicIcon" data-i18n="topics.icon">Icono</label>
                    <div class="icon-picker" id="iconPicker">
                        <button type="button" class="icon-option selected" data-icon="üìÅ">üìÅ</button>
                        <button type="button" class="icon-option" data-icon="üåç">üåç</button>
                        <button type="button" class="icon-option" data-icon="üí∞">üí∞</button>
                        <button type="button" class="icon-option" data-icon="‚öñÔ∏è">‚öñÔ∏è</button>
                        <button type="button" class="icon-option" data-icon="üèõÔ∏è">üèõÔ∏è</button>
                        <button type="button" class="icon-option" data-icon="üî¨">üî¨</button>
                        <button type="button" class="icon-option" data-icon="üíª">üíª</button>
                        <button type="button" class="icon-option" data-icon="üß†">üß†</button>
                        <button type="button" class="icon-option" data-icon="üìö">üìö</button>
                        <button type="button" class="icon-option" data-icon="üéØ">üéØ</button>
                    </div>
                    <input type="hidden" id="topicIconValue" value="üìÅ">
                </div>

                <div class="form-group">
                    <label for="topicName" data-i18n="topics.name">Nombre del tema *</label>
                    <input type="text" id="topicName" required data-i18n-placeholder="topics.namePlaceholder" placeholder="Ej: Conflicto palestino-israel√≠">
                </div>

                <div class="form-group">
                    <label for="topicDescription" data-i18n="topics.description">Descripci√≥n</label>
                    <textarea id="topicDescription" rows="3" data-i18n-placeholder="topics.descriptionPlaceholder" placeholder="Describe brevemente el tema..."></textarea>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancelTopicBtn" data-i18n="form.cancel">Cancelar</button>
                    <button type="submit" class="btn btn-primary" id="saveTopicBtn" data-i18n="form.save">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <script type="module" src="/src/main.js"></script>
</body>
</html>
